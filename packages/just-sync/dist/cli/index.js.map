{"version":3,"sources":["../../src/cli/index.ts"],"sourcesContent":["#!/usr/bin/env node\nimport { writeFile, mkdir } from 'node:fs/promises';\nimport { join } from 'node:path';\n\nasync function main() {\n  const args = process.argv.slice(2);\n  const cmd = args[0];\n  if (!cmd || cmd === 'help' || cmd === '--help') {\n    console.log('just-sync CLI (MVP)');\n    console.log('  init --adapter sqlite --db-url file:./app.db');\n    console.log('  generate:schema --adapter sqlite --out migrations/');\n    process.exit(0);\n  }\n  if (cmd === 'init') {\n    console.log('Initialized just-sync (stub).');\n    process.exit(0);\n  }\n  if (cmd === 'generate:schema') {\n    const outIdx = args.indexOf('--out');\n    const outDir = (outIdx !== -1 && typeof args[outIdx + 1] === 'string' && args[outIdx + 1]) ? args[outIdx + 1] : 'migrations';\n    await mkdir(outDir as string, { recursive: true });\n    const ddl = `CREATE TABLE IF NOT EXISTS _sync_versions (\\n  table_name   TEXT    NOT NULL,\\n  pk_canonical TEXT    NOT NULL,\\n  version      INTEGER NOT NULL,\\n  PRIMARY KEY (table_name, pk_canonical)\\n);\\n`;\n    const fname = join(outDir as string, `${Date.now()}_sync_versions.sql`);\n    await writeFile(fname, ddl, 'utf8');\n    console.log(`Wrote ${fname}`);\n    process.exit(0);\n  }\n  console.error('Unknown command');\n  process.exit(1);\n}\n\nmain().catch((e) => { console.error(e); process.exit(1); });\n\n"],"mappings":";;;AACA,SAAS,WAAW,aAAa;AACjC,SAAS,YAAY;AAErB,eAAe,OAAO;AACpB,QAAM,OAAO,QAAQ,KAAK,MAAM,CAAC;AACjC,QAAM,MAAM,KAAK,CAAC;AAClB,MAAI,CAAC,OAAO,QAAQ,UAAU,QAAQ,UAAU;AAC9C,YAAQ,IAAI,qBAAqB;AACjC,YAAQ,IAAI,gDAAgD;AAC5D,YAAQ,IAAI,sDAAsD;AAClE,YAAQ,KAAK,CAAC;AAAA,EAChB;AACA,MAAI,QAAQ,QAAQ;AAClB,YAAQ,IAAI,+BAA+B;AAC3C,YAAQ,KAAK,CAAC;AAAA,EAChB;AACA,MAAI,QAAQ,mBAAmB;AAC7B,UAAM,SAAS,KAAK,QAAQ,OAAO;AACnC,UAAM,SAAU,WAAW,MAAM,OAAO,KAAK,SAAS,CAAC,MAAM,YAAY,KAAK,SAAS,CAAC,IAAK,KAAK,SAAS,CAAC,IAAI;AAChH,UAAM,MAAM,QAAkB,EAAE,WAAW,KAAK,CAAC;AACjD,UAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACZ,UAAM,QAAQ,KAAK,QAAkB,GAAG,KAAK,IAAI,CAAC,oBAAoB;AACtE,UAAM,UAAU,OAAO,KAAK,MAAM;AAClC,YAAQ,IAAI,SAAS,KAAK,EAAE;AAC5B,YAAQ,KAAK,CAAC;AAAA,EAChB;AACA,UAAQ,MAAM,iBAAiB;AAC/B,UAAQ,KAAK,CAAC;AAChB;AAEA,KAAK,EAAE,MAAM,CAAC,MAAM;AAAE,UAAQ,MAAM,CAAC;AAAG,UAAQ,KAAK,CAAC;AAAG,CAAC;","names":[]}